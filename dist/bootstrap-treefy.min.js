+function(a){"use strict";function b(b){arguments;return this.each(function(){var c=a(this),e=c.data("treeFy");if(!e){var f=a.extend(!0,{},a.fn.treeFy.defaults,"object"==typeof b&&b);c.data("treeFy",e=new d(this,f))}"string"==typeof b&&e[b].call(c)})}var c=function(a){var b=/treetable-([A-Za-z0-9_-]+)/,c=/treetable-parent-([A-Za-z0-9_-]+)/;this.row=a,this.id=null,b.test(this.row.attr("data-node"))&&(this.id=b.exec(this.row.attr("data-node"))[1]),this.parentId=null,c.test(this.row.attr("data-pnode"))&&(this.parentId=c.exec(this.row.attr("data-pnode"))[1]),this.children=[],this.status=!0};c.prototype.addChildren=function(b){var d=this,e="treetable-parent-"+d.id,f=b.find('[data-pnode="'+e+'"]');0!=f.length&&a.each(f,function(e,f){var g=new c(a(f));d.children.push(g),g.addChildren(b)})},c.prototype.initIndent=function(b){this.row.find(".treetable-indent").remove();for(var c=this.row.find(".treetable-expander"),d=this.getDepth(b.$table),e=0;d>e;e++){var f=b.options.indentTemplate;a(f).insertBefore(c)}},c.prototype.initExpander=function(b){var c=this,d=c.row.find("td").get(b.options.treeColumn),e=c.row.find(".treetable-expander");e&&e.remove();var f=b.options.expanderTemplate;a(f).prependTo(d).click(function(){c.toggle()})},c.prototype.renderExpand=function(a){var b=this.row.find(".treetable-expander");b?this.row.hasClass("treetable-collapsed")?(b.removeClass(a.options.expanderExpandedClass),b.addClass(a.options.expanderCollapsedClass)):(b.removeClass(a.options.expanderCollapsedClass),b.addClass(a.options.expanderExpandedClass)):(this.initExpander(a),this.renderExpand(a))},c.prototype.toggle=function(){this.row.hasClass("treetable-expanded")?this.isLeaf()||this.row.hasClass("treetable-collapsed")||(this.row.removeClass("treetable-expanded"),this.row.addClass("treetable-collapsed")):this.isLeaf()||this.row.hasClass("treetable-expanded")||(this.row.removeClass("treetable-collapsed"),this.row.addClass("treetable-expanded"))},c.prototype.isLeaf=function(){return 0===this.children.length},c.prototype.isCollapsed=function(a){var b=0===this.getDepth(a);return b?!1:this.getParentNode(a).row.hasClass("treetable-collapsed")?!0:this.getParentNode(a).isCollapsed(a)},c.prototype.getDepth=function(a){return null===this.getParentNode(a)?0:this.getParentNode(a).getDepth(a)+1},c.prototype.getParentNode=function(a){return null===this.parentId?null:this.getNodeById(this.parentId,a)},c.prototype.getNodeById=function(a,b){var d="treetable-"+a,e=b.find('[data-node="'+d+'"]'),f=new c(e);return f.addChildren(b),f};var d=function(b,c){this.options=c,this.$table=a(b);var d=this.getAllNodes();this.initTree(d)};d.VERSION="0.0.1",d.prototype.getAllNodes=function(){var b=this,d=a.grep(b.$table.find("tr"),function(b){var c=a(b).attr("data-node"),d=/treetable-([A-Za-z0-9_-]+)/;return d.test(c)}),e=a(d),f=[];return a.each(e,function(){var d=new c(a(this));d.addChildren(b.$table),f.push(d)}),f},d.prototype.initTree=function(b){var c=this,d=[];a.each(b,function(){var a=0===this.children.length;a||("expanded"===c.options.initState?this.row.addClass("treetable-expanded"):"collapsed"===c.options.initState&&this.row.addClass("treetable-collapsed")),this.parentId||d.push(this)}),c.initNode(d),c.render(d)},d.prototype.initNode=function(b){var c=this;a.each(b,function(){c.initNode(this.children),this.initExpander(c),this.initIndent(c);var a=this.row,b=[];b.push(this),a.find(".treetable-expander").on("click",function(a){a.stopPropagation(),c.render(b)})})},d.prototype.render=function(b){var c=this,d=c.options.collapseAnimateCallback,e=c.options.expandAnimateCallback;a.each(b,function(){this.isCollapsed(c.$table)?d?d(this.row):this.row.hide():e?e(this.row):this.row.show(),this.isLeaf()||(this.renderExpand(c),c.render(this.children))})};var e=a.fn.treeFy;a.fn.treeFy=b,a.fn.treeFy.Constructor=d,a.fn.treeFy.defaults={expanderTemplate:'<span class="treetable-expander"></span>',indentTemplate:'<span class="treetable-indent"></span>',expanderExpandedClass:"fa fa-angle-down",expanderCollapsedClass:"fa fa-angle-right",treeColumn:0,initState:"expanded",collapseAnimateCallback:function(a){a.hide()},expandAnimateCallback:function(a){a.show()}},a.fn.treeFy.noConflict=function(){return a.fn.treeFy=e,this}}(jQuery);